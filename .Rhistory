claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% na.omit(bene_count) %>% group_by(bene_count)
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% select(bene_count) %>% na.omit() %>% unlist(use.names = FALSE) %>% quantile()
s <- claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% select(bene_count) %>% na.omit() %>% unlist(use.names = FALSE) %>% quantile()
x
s
class(s)
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% group_by(bene_count) %>% summarise(bene_count = median(bene_count,na.rm = TRUE), n = n(), Q1 = quantile(na.omit(bene_count), c(0.25, 0.5, 0.75)))
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = median(bene_count,na.rm = TRUE), n = n(), Q1 = quantile(na.omit(bene_count), c(0.25, 0.5, 0.75)))
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = median(bene_count,na.rm = TRUE), n = n(), Q1 = quantile(na.omit(bene_count), c(0.25, 0.5, 0.75)) %>% cat())
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = median(bene_count,na.rm = TRUE), n = n(), Q1 = quantile(na.omit(bene_count), c(0.25, 0.5, 0.75)) %>% cat())
s %>% cat()
s %>% paste0()
s %>% paste0(, collapse = '')
s %>% paste0(collapse = '')
s %>% paste0([c(2,4)], collapse = '')
s %>% paste0(.[c(2,4)], collapse = '')
s %>% paste0(.[c(2,4)], collapse = ' ')
s
s %>% paste0(.[c(2,4), 1], collapse = ' ')
s %>% paste0(.[c(2,4)], collapse = ' ')
s %>% .[c(2,4)] %>% paste0(collapse = ' ')
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = median(bene_count,na.rm = TRUE), n = n(), Q1 = quantile(na.omit(bene_count), c(0.25, 0.5, 0.75)))
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = paste0(median(bene_count,na.rm = TRUE), "(", s %>% .[c(2,4)] %>% paste0(collapse = ' '), ")"), n = n(), )
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = paste0(median(bene_count,na.rm = TRUE), "(", s %>% .[c(2,4)] %>% paste0(collapse = ', '), ")"), n = n(), )
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = paste0(median(bene_count,na.rm = TRUE), "(", s %>% .[c(2,4)] %>% paste0(collapse = ','), ")"), n = n(), )
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = paste0(median(bene_count,na.rm = TRUE), "(", s %>% .[c(2,4)] %>% paste0(collapse = ', '), ")"), n = n(), )
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = paste0(round(median(bene_count,na.rm = TRUE), 1), "(", s %>% .[c(2,4)] %>% paste0(collapse = ', '), ")"), n = n(), )
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = paste0(round(median(bene_count,na.rm = TRUE), 4), "(", s %>% .[c(2,4)] %>% paste0(collapse = ', '), ")"), n = n(), )
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = paste0(median(bene_count,na.rm = TRUE), "(", s %>% .[c(2,4)] %>% paste0(collapse = ', '), ")"), n = n(), )
View(claims)
claims %>% filter(drug_name %in% opioids, total_claim_count > 10)
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% .[1, 8]
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% .[1, 8:9]
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% .[1, 9:10]
stats_opioids
stats_opioids <- claims %>% filter(drug_name %in% opioids) %>% group_by(drug_name) %>%
summarise(claim_count = sum(total_claim_count), .groups = "drop") %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
stats_opioids
stats_opioids[1:5,]
stats_opioids[1:5,1]
stats_opioids[1:5,]
stats_opioids[1:5,] %>% rowwise() %>% sum()
stats_opioids[-c(1:5),]
stats_opioids[-c(1:5),] %>% summarise(sum(claim_count), sum(claim_percentage))
stats_opioids[-c(1:5),] %>% summarise(claim_count = sum(claim_count), claim_percentage = sum(claim_percentage))
stats_opioids[-c(1:5),] %>% summarise(drug_name="others", claim_count = sum(claim_count), claim_percentage = sum(claim_percentage))
stats_opioids[1:5,] %>% left_join(stats_opioids[-c(1:5),] %>% summarise(drug_name="others", claim_count = sum(claim_count), claim_percentage = sum(claim_percentage)))
stats_opioids[1:5,] %>% left_join(stats_opioids[-c(1:5),] %>% summarise(drug_name="others", claim_count = sum(claim_count), claim_percentage = sum(claim_percentage)))
stats_opioids[1:5,] %>% full_join(stats_opioids[-c(1:5),] %>% summarise(drug_name="others", claim_count = sum(claim_count), claim_percentage = sum(claim_percentage)))
stats_opioids[1:5,] %>% full_join(stats_opioids[-c(1:5),] %>% summarise(drug_name="others", claim_count = sum(claim_count), claim_percentage = sum(claim_percentage)))
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = paste0(
median(bene_count, na.rm = TRUE),
"(",
s %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"
),
n = n(),
)
)top_prescribers
top_prescribers
top_prescribers %>% select(NPI) %>% distinct()
top_5_states
top_prescribers %>% head(nrow(.)*0.05)
top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI)
top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI) %>% distinct()
top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI) %>% unlist(use.names = FALSE)
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>% summarise(bene_count = paste0(
median(bene_count, na.rm = TRUE),
"(",
s %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"
),
n = n(),
)
claims %>% filter(drug_name %in% opioids, NPI %in% top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI) %>% unlist(use.names = FALSE)) %>% summarise(bene_count = paste0(
median(bene_count, na.rm = TRUE),
"(",
s %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"
),
n = n(),
)
claims %>% filter(drug_name %in% opioids, NPI %in% top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI) %>% unlist(use.names = FALSE))
top_5_prescribers <- top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI) %>% unlist(use.names = FALSE)
top_5_prescribers
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers)
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>% summarise(bene_count = paste0(
median(bene_count, na.rm = TRUE),
"(",
s %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"
),
n = n(),
)
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>% summarise(bene_count = paste0(
median(bene_count, na.rm = TRUE),
"(", s %>% .[c(2, 4)] %>% paste0(collapse = ', '), ")" ), n = n())
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>%
summarise(bene_count = paste0(median(bene_count, na.rm = TRUE), "(",
quantile(bene_count) %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"
),
n = n(),
)
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>%
summarise(bene_count = paste0(median(bene_count, na.rm = TRUE), "(",
quantile(na.omit(bene_count)) %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"
),
n = n(),
)
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
summarise(bene_count = paste0(median(bene_count, na.rm = TRUE), "(",
quantile(na.omit(bene_count)) %>% .[c(2, 4)] %>%
paste0(collapse = ', '), ")" ), n = n())
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>%
summarise(bene_count = paste0(median(bene_count, na.rm = TRUE), "(",
quantile(na.omit(bene_count)) %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"), n = n())
top_5_prescribers <- top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI) %>%
unlist(use.names = FALSE)
top_5_prescribers <- top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI) %>%
unlist(use.names = FALSE)
top_5_prescribers
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
summarise(bene_count = paste0(median(bene_count, na.rm = TRUE), "(",
quantile(na.omit(bene_count)) %>% .[c(2, 4)] %>%
paste0(collapse = ', '), ")" ), n = n())
claims_10pp <- claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>%
summarise(n = n(), bene_count = paste0(median(bene_count, na.rm = TRUE), "(",
quantile(na.omit(bene_count)) %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"))
top_5_prescribers <- top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI) %>%
unlist(use.names = FALSE)
claims_5pp <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
summarise(n = n(), bene_count = paste0(median(bene_count, na.rm = TRUE), "(",
quantile(na.omit(bene_count)) %>%
.[c(2, 4)] %>% paste0(
collapse = ', '),
")" ), n = n())
claims_5pp
t(claims_5pp)
cbind(t(claims_5pp), t(claims_10pp))
cbind(t(claims_10pp), t(claims_5pp))
claims_10pp <- claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>%
summarise(n = n(), `Median (Q1, Q3)` = paste0(median(bene_count, na.rm = TRUE), "(",
quantile(na.omit(bene_count)) %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"))
top_5_prescribers <- top_prescribers %>% head(nrow(.)*0.05) %>% select(NPI) %>%
unlist(use.names = FALSE)
claims_5pp <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
summarise(n = n(), `Median (Q1, Q3)` = paste0(median(bene_count, na.rm = TRUE), "(",
quantile(na.omit(bene_count)) %>%
.[c(2, 4)] %>% paste0(
collapse = ', '),
")" ), n = n())
cbind(t(claims_10pp), t(claims_5pp))
stats_opioids[1:5,] %>% full_join(
stats_opioids[-c(1:5),] %>%
summarise(
drug_name = "others",
claim_count = sum(claim_count),
claim_percentage = sum(claim_percentage)
)
)
stats_opioids[1:5,] %>% full_join(
stats_opioids[-c(1:5),] %>%
summarise(
drug_name = "others",
claim_count = paste0(sum(claim_count), "(", sum(claim_percentage), "%)")
)
)
stats_opioids[1:5,]
stats_opioids[1:5,] %>% summarise(
claim_count = paste0(sum(claim_count), "(", sum(claim_percentage), "%)")
)
stats_opioids[1:5,] %>% group_by(drug_name) %>% summarise(
claim_count = paste0(sum(claim_count), "(", sum(claim_percentage), "%)")
)
stats_opioids[1:5,] %>% group_by(drug_name) %>% summarise(
claim_count = paste0(sum(claim_count), " (", sum(claim_percentage), "%)")
)
stats_opioids[1:5, ] %>% group_by(drug_name) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), "(",
sum(claim_percentage), "%)")))
stats_opioids[1:5, ] %>% group_by(drug_name) %>% arrange(claim_count) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), " (",
sum(claim_percentage), "%)")))
claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>%
summarise(n = n(), `Median (Q1, Q3)` = paste0(median(total_30_day_fill_count, na.rm = TRUE), "(",
quantile(na.omit(total_30_day_fill_count)) %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"))
table_total_claim_count <- claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>%
summarise(n = n(), `Median (Q1, Q3)` = paste0(median(total_claim_count, na.rm = TRUE), "(",
quantile(na.omit(total_claim_count)) %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"))
total_claim_count
table_total_claim_count
table_total_day_supply
table_total_day_supply <- claims %>% filter(drug_name %in% opioids, total_claim_count > 10) %>%
summarise(n = n(), `Median (Q1, Q3)` = paste0(median(total_day_supply, na.rm = TRUE), "(",
quantile(na.omit(total_day_supply)) %>% .[c(2, 4)] %>% paste0(collapse = ', '),
")"))
table_total_day_supply
stats_opioids[1:5, ] %>% group_by(drug_name) %>% arrange(claim_count) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), " (",
sum(claim_percentage), "%)")))
stats_opioids[1:5, ] %>% filter(NPI %in% top_5_prescribers) %>% group_by(drug_name) %>% arrange(claim_count) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), " (",
sum(claim_percentage), "%)")))
View(claims)
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>% group_by(drug_name) %>% arrange(claim_count) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), " (",
sum(claim_percentage), "%)")))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers)
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% arrange(claim_count) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), " (",
sum(claim_percentage), "%)")))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% arrange(claim_count) %>%
summarise(claim_count = paste0(sum(claim_count), " (", sum(claim_percentage), "%)"))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count),
.groups = "drop")
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count),
.groups = "drop") %>% arrange(claim_count) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), " (",
sum(claim_percentage), "%)")))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count),
.groups = "drop") %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count),
.groups = "drop") %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), " (",
sum(claim_percentage), "%)")))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count),
.groups = "drop") %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)"))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count),
.groups = "drop") %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>% ungroup() %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)"))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count),
.groups = "drop") %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>% group_by(drug_name)
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count),
.groups = "drop") %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>% group_by(drug_name) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)"))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count),
.groups = "drop") %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count)) %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count)) %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)"))
claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count)) %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count)) %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
View(A)
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
View(A)
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% mutate(claim_count = sum(total_claim_count))
View(A)
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count))
View(A)
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
table_drugs
table_drugs <- stats_opioids[1:5, ] %>% group_by(drug_name) %>% arrange(claim_count) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), " (",
sum(claim_percentage), "%)")))
table_drugs
A
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)"))
A
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)"))
A
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>% group_by(drug_name) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)"))
A
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
A
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1))
A
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>% group_by(drug_name) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)"))
A
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
A
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>% .[1:5, ]
A
A <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count)) %>% .[1:5, ] %>% group_by(drug_name) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)"))
A
table_drugs_B <- table_drugs_B_Partial %>% .[1:5, ] %>%
group_by(drug_name) %>% summarise(
claim_count = paste0(
sum(claim_count), " (", sum(claim_percentage), "%)")
) %>% full_join(table_drugs_B_Partial[-c(1:5), ] %>%
summarise(
drug_name = "others",
claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")))
table_drugs_B_Partial <- claims %>% filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
table_drugs_B <- table_drugs_B_Partial %>% .[1:5, ] %>%
group_by(drug_name) %>% summarise(
claim_count = paste0(
sum(claim_count), " (", sum(claim_percentage), "%)")
) %>% full_join(table_drugs_B_Partial[-c(1:5), ] %>%
summarise(
drug_name = "others",
claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")))
table_drugs_B
arrange(table_drugs_B)
sort(table_drugs_B)
?arrange
order(table_drugs_B)
table_drugs_B[c(2,3,5,1,6,4),]
drug_name = "others",
table_drugs_B <- table_drugs_B_Partial %>% .[1:5, ] %>%
group_by(drug_name) %>% summarise(
claim_count = paste0(
sum(claim_count), " (", sum(claim_percentage), "%)")
) %>% full_join(table_drugs_B_Partial[-c(1:5), ] %>%
summarise(
drug_name = "others",
claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage),
"%)")))
table_drugs_B
table_drugs_B %>% .[c(2,3,5,1,6,4),]
drug_name = "others",
table_drugs_B <- table_drugs_B %>% .[c(2,3,5,1,6,4),]
table_drugs_B
claims %>% filter(drug_name %in% opioids) %>% group_by(drug_name) %>%
summarise(claim_count = sum(total_claim_count), .groups = "drop") %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
table_drugs
table_drugs_B
table_drugs%>% .[c(2,3,5,1,6,4),]
table_drugs %>% .[c(2,3,5,4, 1,6),]
################################################################################
table_drugs <- stats_opioids[1:5, ] %>% group_by(drug_name) %>%
arrange(claim_count) %>%
summarise(claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage), "%)")) %>%
full_join(stats_opioids[-c(1:5), ] %>%
summarise(drug_name = "others",
claim_count = paste0(sum(claim_count), " (",
sum(claim_percentage), "%)")))
#
table_drugs <- table_drugs %>% .[c(2,3,5,4, 1,6),]
################################################################################
table_drugs_B_Partial <- claims %>%
filter(drug_name %in% opioids, NPI %in% top_5_prescribers) %>%
group_by(drug_name) %>% summarise(claim_count = sum(total_claim_count)) %>%
ungroup() %>%
mutate(claim_percentage = round(100 * claim_count / sum(claim_count), 1)) %>%
arrange(desc(claim_count))
#
table_drugs_B <- table_drugs_B_Partial %>% .[1:5, ] %>%
group_by(drug_name) %>% summarise(
claim_count = paste0(
sum(claim_count), " (", sum(claim_percentage), "%)")
) %>% full_join(table_drugs_B_Partial[-c(1:5), ] %>%
summarise(
drug_name = "others",
claim_count = paste0(sum(claim_count),
" (", sum(claim_percentage),
"%)")))
#
table_drugs_B <- table_drugs_B %>% .[c(2,3,5,1,6,4),]
table_drugs_B
table_drugs
table_drugs %>% left_join(table_drugs_B, by=drug_name)
table_drugs %>% left_join(table_drugs_B, by="drug_name")
t(claims_10pp)
t(claims_10pp) %>% left_join(t(claims_5pp))
t(claims_5pp)
cbind(t(claims_10pp), t(claims_5pp))
table(cbind(t(claims_10pp), t(claims_5pp)))
cbind(t(claims_10pp), t(claims_5pp))
table(as.data.frame(cbind(t(claims_10pp), t(claims_5pp))))
cbind(t(claims_10pp), t(claims_5pp))
as.data.frame(cbind(t(claims_10pp), t(claims_5pp)))
